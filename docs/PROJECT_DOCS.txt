*** pamiÄ™taj aby zawasze aktualizowaÄ‡ @PROJECT_DOCS.txt  ***


DOKUMENTACJA PROJEKTU S02E05
===========================

CEL I WYKORZYSTANIE DOKUMENTU
----------------------------
Ten dokument sÅ‚uÅ¼y jako:
1. CENTRALNE Å¹RÃ“DÅO WIEDZY o projekcie - wszystkie decyzje, komponenty i postÄ™py sÄ… tu zapisywane
2. DOKUMENTACJA TECHNICZNA - zawiera szczegÃ³Å‚y implementacyjne i wymagania
3. PLAN DZIAÅANIA - pokazuje co zostaÅ‚o zrobione i co jest do zrobienia
4. PRZEWODNIK DEBUGOWANIA - w razie problemÃ³w pomoÅ¼e zlokalizowaÄ‡ ÅºrÃ³dÅ‚o bÅ‚Ä™du

BÄ™dÄ™ aktywnie wykorzystywaÅ‚ ten dokument do:
- Åšledzenia postÄ™pu implementacji
- Zapisywania waÅ¼nych decyzji projektowych
- Dokumentowania API i interfejsÃ³w miÄ™dzy komponentami
- Aktualizowania statusu zadaÅ„
- Zapisywania napotkanych problemÃ³w i ich rozwiÄ…zaÅ„

1. OPIS ZADANIA
--------------
1.1 Cel
    - Pobranie i analiza publikacji prof. Maja
    - Przetworzenie rÃ³Å¼nych typÃ³w mediÃ³w (tekst, obraz, audio)
    - Wygenerowanie odpowiedzi na pytania centrali

1.2 Wymagania
    - Analiza caÅ‚ego dokumentu (tekst, grafiki, dÅºwiÄ™ki)
    - UwzglÄ™dnienie kontekstu materiaÅ‚Ã³w
    - Wykorzystanie RAG z modelami OpenAI
    - Odpowiedzi w formacie JSON

2. STRUKTURA PROJEKTU
--------------------
project/
â”œâ”€â”€ agents/
â”‚   â””â”€â”€ base_agent.py     # Bazowa klasa dla wszystkich agentÃ³w
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ PROJECT_DOCS.txt  # Ten plik
â”œâ”€â”€ tasks/
â”‚   â””â”€â”€ taskS02E05.py     # âœ… PeÅ‚na implementacja zadania
â”œâ”€â”€ main_agents.py        # GÅ‚Ã³wny plik uruchomieniowy
â””â”€â”€ .env                  # Konfiguracja modeli

3. ÅšRODOWISKO I KONFIGURACJA
---------------------------
3.1 Modele OpenAI
    EMBEDDING_MODEL=text-embedding-3-large  # Embedingi dokumentÃ³w
    LLM_MODEL=gpt-4o                       # Analiza tekstu i generowanie odpowiedzi
    VISION_MODEL=gpt-4o                    # Analiza obrazÃ³w
    AUDIO_MODEL=whisper-1                  # Transkrypcja audio

3.2 ZaleÅ¼noÅ›ci
    requests         # HTTP requests
    beautifulsoup4   # Parsowanie HTML
    openai           # API OpenAI
    python-dotenv    # Zmienne Å›rodowiskowe
    numpy            # Operacje na wektorach
    faiss-cpu        # Baza wektorowa

4. ARCHITEKTURA SYSTEMU
----------------------
4.1 Komponenty

    BaseAgent âœ…
    - Status: Zaimplementowany
    - FunkcjonalnoÅ›ci:
      * _create_embeddings() - tworzenie embedingÃ³w dla wszystkich agentÃ³w
      * handle_error() - ujednolicona obsÅ‚uga bÅ‚Ä™dÃ³w
      * log_info() - spÃ³jne logowanie
      * process() - abstrakcyjna metoda do implementacji
    - Konfiguracja:
      * Automatyczne Å‚adowanie zmiennych Å›rodowiskowych
      * Konfiguracja OpenAI API
      * System logowania z formatowaniem

    CollectorAgent âœ…
    - Status: Zaimplementowany
    - FunkcjonalnoÅ›ci:
      * download_article() - pobieranie artykuÅ‚u z API
      * download_questions() - pobieranie pytaÅ„
      * save_raw_data() - zapisywanie surowych danych
      * _check_existing_data() - sprawdzanie czy dane juÅ¼ istniejÄ…
      * _load_existing_data() - wczytywanie istniejÄ…cych danych
    - Cache:
      * Automatyczne wykrywanie istniejÄ…cych danych
      * MoÅ¼liwoÅ›Ä‡ wyboru miÄ™dzy uÅ¼yciem cache a pobraniem nowych danych
      * Przechowywanie w data/downloads/

    ProcessorAgent âœ…
    - Status: Zaimplementowany
    - FunkcjonalnoÅ›ci:
      * _process_text() - podziaÅ‚ tekstu na fragmenty (max 1000 znakÃ³w)
      * _process_images() - analiza obrazÃ³w przez VISION_MODEL
      * _process_audio() - transkrypcja audio przez AUDIO_MODEL
      * _check_existing_processed_data() - sprawdzanie przetworzonych danych
      * _load_processed_data() - wczytywanie istniejÄ…cych przetworzonych danych
    - Cache:
      * Automatyczne wykrywanie przetworzonych danych
      * MoÅ¼liwoÅ›Ä‡ wyboru miÄ™dzy uÅ¼yciem cache a ponownym przetwarzaniem
      * Przechowywanie w data/processed/
    - Struktura danych:
      * processed_data.json - zawartoÅ›Ä‡ tekstowa
        - text: {chunks: [...]}
        - images: {descriptions: [...]}
        - audio: {transcripts: [...]}
      * embeddings.json - wektory embeddingÃ³w
        - text_embeddings: [...]
        - image_embeddings: [...]
        - audio_embeddings: [...]

    ResponderAgent âœ…
    - Status: Zaimplementowany
    - FunkcjonalnoÅ›ci:
      * _load_knowledge_base() - wczytywanie bazy wiedzy
      * _generate_answer() - generowanie odpowiedzi
      * _find_relevant_chunks() - wyszukiwanie kontekstu
      * _save_answers() - zapisywanie odpowiedzi
    - Struktura knowledge_base:
      * text: {chunks: [...], embeddings: [...]}
      * images: {descriptions: [...], embeddings: [...]}
      * audio: {transcripts: [...], embeddings: [...]}

4.2 PrzepÅ‚yw Danych
    Collector -> Processor -> Responder -> JSON

5. API I ENDPOINTY
-----------------
5.1 ZewnÄ™trzne API
    - ArtykuÅ‚: GET /articles/{article_id}
      * Zwraca peÅ‚nÄ… treÅ›Ä‡ artykuÅ‚u z metadanymi
      * ObsÅ‚uguje tekst, HTML, obrazy i audio
      * Format: application/json

    - Pytania: GET /questions/{article_id}
      * Zwraca listÄ™ pytaÅ„ do artykuÅ‚u
      * Format: application/json
      * Struktura ID: "ID-pytania-XX"

    - Odpowiedzi: POST /answers/{article_id}
      * Przyjmuje wygenerowane odpowiedzi
      * Format: application/json
      * Walidacja zgodnoÅ›ci z pytaniami

5.2 Interfejsy KomponentÃ³w

    BaseAgent:
    - process(data: Any) -> Dict
      * Abstrakcyjna metoda do implementacji
      * Zwraca przetworzone dane
    - handle_error(error: Exception, context: str)
      * ObsÅ‚uga i logowanie bÅ‚Ä™dÃ³w
    - log_info(message: str)
      * Logowanie informacji

    CollectorAgent:
    - download_article() -> Dict
      * Pobiera i parsuje artykuÅ‚
      * Zwraca sÅ‚ownik z zawartoÅ›ciÄ…
    - download_questions() -> List[str]
      * Pobiera i formatuje pytania
    - save_raw_data(data: Dict)
      * Zapisuje pobrane dane

    ProcessorAgent:
    - process() -> Dict
      * Przetwarza wszystkie typy danych
      * Tworzy embeddingi
      * Zwraca przetworzone dane
    - _process_text() -> Tuple[List[str], List[float]]
      * Dzieli tekst na fragmenty
      * Tworzy embeddingi tekstu
    - _process_images() -> Tuple[List[str], List[float]]
      * Analizuje obrazy
      * Tworzy embeddingi obrazÃ³w
    - _process_audio() -> Tuple[List[str], List[float]]
      * Transkrybuje audio
      * Tworzy embeddingi audio

    ResponderAgent:
    - process() -> Dict[str, str]
      * Generuje odpowiedzi na pytania
      * Zwraca sÅ‚ownik {id_pytania: odpowiedÅº}
    - _find_relevant_chunks() -> List[str]
      * Wyszukuje kontekst dla pytania
    - _generate_answer() -> str
      * Generuje odpowiedÅº na podstawie kontekstu

5.3 Format Danych
    {
        "ID-pytania-01": "krÃ³tka odpowiedÅº w 1 zdaniu",
        "ID-pytania-02": "krÃ³tka odpowiedÅº w 1 zdaniu",
        "ID-pytania-03": "krÃ³tka odpowiedÅº w 1 zdaniu",
        "ID-pytania-NN": "krÃ³tka odpowiedÅº w 1 zdaniu"
    }

6. STATUS I POSTÄ˜P
-----------------
6.1 Zrobione âœ…
    [x] Struktura projektu
    [x] BaseAgent
    [x] CollectorAgent
    [x] ProcessorAgent
    [x] ResponderAgent
    [x] Testy jednostkowe
    [x] Testy integracyjne
    [x] Dokumentacja API i interfejsÃ³w
    [x] Implementacja gÅ‚Ã³wnego taska
      * PeÅ‚ny pipeline przetwarzania
      * ObsÅ‚uga bÅ‚Ä™dÃ³w
      * Logowanie postÄ™pu
      * Zapisywanie wynikÃ³w
    [x] System cache dla pobranych danych
    [x] System cache dla przetworzonych danych
    [x] Interaktywny wybÃ³r uÅ¼ycia cache

6.2 Do zrobienia ğŸ”„
    [ ] Optymalizacja wykorzystania pamiÄ™ci przy duÅ¼ych plikach
    [ ] System czyszczenia starych danych cache

7. PROBLEMY I ROZWIÄ„ZANIA
------------------------
7.1 Architektura
    - Wprowadzono wspÃ³lnÄ… klasÄ™ bazowÄ…
    - Ujednolicono obsÅ‚ugÄ™ bÅ‚Ä™dÃ³w i logowanie
    - Zoptymalizowano zarzÄ…dzanie zasobami AI
    - Wprowadzono moduÅ‚owÄ… strukturÄ™ agentÃ³w
    - Rozdzielono przechowywanie danych tekstowych i embeddingÃ³w
    - Zapewniono spÃ³jnÄ… strukturÄ™ danych miÄ™dzy agentami

7.2 Przetwarzanie Danych
    - Inteligentny podziaÅ‚ tekstu na fragmenty
    - Efektywne wyszukiwanie kontekstu
    - ÅÄ…czenie rÃ³Å¼nych typÃ³w mediÃ³w
    - Optymalizacja wykorzystania modeli AI
    - Osobne przechowywanie embeddingÃ³w dla lepszej wydajnoÅ›ci

7.3 Testy i Debugowanie
    - Naprawiono problemy z testami integracyjnymi:
      * Dodano prawidÅ‚owe mockowanie OpenAI API
      * Wprowadzono rÃ³Å¼ne wartoÅ›ci embeddings dla rÃ³Å¼nych typÃ³w danych
      * Dodano testy rÃ³Å¼nych scenariuszy bÅ‚Ä™dÃ³w
      * Rozszerzono testy spÃ³jnoÅ›ci danych
    - Wprowadzono lepsze mockowanie zewnÄ™trznych zaleÅ¼noÅ›ci:
      * UÅ¼ycie MagicMock dla kompleksowych obiektÃ³w
      * Dynamiczne generowanie odpowiedzi testowych
      * Symulacja rÃ³Å¼nych scenariuszy API
    - Dodano testowe przypadki brzegowe:
      * Puste dane wejÅ›ciowe
      * BÅ‚Ä™dy sieci
      * Limity API
      * NieprawidÅ‚owe formaty danych

7.3 DokÅ‚adnoÅ›Ä‡ odpowiedzi
    - Problem: NiektÃ³re odpowiedzi sÄ… nieprecyzyjne lub pomijajÄ… kluczowe szczegÃ³Å‚y
    - RozwiÄ…zanie:
      * ZwiÄ™kszenie wagi dla ÅºrÃ³deÅ‚ audio i obrazÃ³w w wyszukiwaniu kontekstu
      * Dodanie walidacji odpowiedzi wzglÄ™dem znalezionych fragmentÃ³w
      * Wymaganie cytowania ÅºrÃ³dÅ‚a informacji w kontekÅ›cie
      * Priorytetyzacja dokÅ‚adnych dopasowaÅ„ nad podobieÅ„stwem semantycznym

7.4 Wyszukiwanie kontekstu
    - Obecny problem:
      * NiektÃ³re fragmenty z wysokim podobieÅ„stwem nie zawierajÄ… odpowiedzi
      * WaÅ¼ne informacje mogÄ… byÄ‡ w fragmentach o niÅ¼szym podobieÅ„stwie
    - Planowane usprawnienia:
      * Dwuetapowe wyszukiwanie: najpierw szersze, potem precyzyjne
      * Osobne wagi dla rÃ³Å¼nych typÃ³w ÅºrÃ³deÅ‚ (tekst/audio/obrazy)
      * Filtrowanie fragmentÃ³w niezawierajÄ…cych kluczowych sÅ‚Ã³w

8. NOTATKI ROZWOJOWE
-------------------
- System jest gotowy do testÃ³w wydajnoÅ›ciowych
- NastÄ™pne kroki:
  1. Optymalizacja wykorzystania zasobÃ³w
  2. Testy wydajnoÅ›ciowe
  3. Testy obciÄ…Å¼eniowe
  4. Testy bezpieczeÅ„stwa

---
Ostatnia aktualizacja: [2024-03-19] 